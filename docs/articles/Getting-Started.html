<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Getting Stated with classyfireR • classyfireR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Getting Stated with classyfireR">
<meta property="og:description" content="classyfireR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">classyfireR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.8</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Getting-Started.html">Getting Stated with classyfireR</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/aberHRML/classyfireR/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="Getting-Started_files/header-attrs-2.8/header-attrs.js"></script><script src="Getting-Started_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Getting Stated with classyfireR</h1>
                        <h4 class="author">Thomas Wilson</h4>
            <address class="author_afil">
      Institute of Biological, Environmental &amp; Rural Sciences (IBERS), Aberystwyth University, UK<br><a class="author_email" href="mailto:#"></a><a href="mailto:tpw2@aber.ac.uk" class="email">tpw2@aber.ac.uk</a>
      </address>
                  
      
      <small class="dont-index">Source: <a href="https://github.com/aberHRML/classyfireR/blob/master/vignettes/Getting-Started.Rmd"><code>vignettes/Getting-Started.Rmd</code></a></small>
      <div class="hidden name"><code>Getting-Started.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p><a href="http://classyfire.wishartlab.com/">ClassyFire</a> is a web-based application for automated structural classification of chemical compounds.</p>
<p>The <code>classyfireR</code> R package provides access to the ClassyFire RESTful API for retrieving existing compound classifications and submitted structures to the web-server for classification.</p>
</div>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>classyfireR can be installed from CRAN or, for the latest development version, directly from GitHub using the <code>remotes</code> package.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">'classyfireR'</span><span class="op">)</span>

<span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html">install_github</a></span><span class="op">(</span><span class="st">'aberHRML/classyfireR'</span><span class="op">)</span></code></pre></div>
</div>
<div id="retrieving-classifications" class="section level2">
<h2 class="hasAnchor">
<a href="#retrieving-classifications" class="anchor"></a>Retrieving Classifications</h2>
<p>To retrieve classifications that are already available simply provide an InChI key to the <code>get_classification</code> function.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/aberHRML/classyfireR">classyfireR</a></span><span class="op">)</span>
<span class="co">#&gt; Loading required package: magrittr</span>

<span class="va">Classification</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_classification.html">get_classification</a></span><span class="op">(</span><span class="st">'BRMWTNUJHUMWMS-LURJTMIESA-N'</span><span class="op">)</span>
<span class="co">#&gt; ✔ BRMWTNUJHUMWMS-LURJTMIESA-N</span>

<span class="va">Classification</span>
<span class="co">#&gt; ── ClassyFire Object ───────────────────────────────────── classyfireR v0.3.8 ── </span>
<span class="co">#&gt; Object Size: 18.2 Kb </span>
<span class="co">#&gt;  </span>
<span class="co">#&gt; Info: </span>
<span class="co">#&gt; • InChIKey=BRMWTNUJHUMWMS-LURJTMIESA-N</span>
<span class="co">#&gt;   </span>
<span class="co">#&gt; • [H][C@](N)(CC1=CN(C)C=N1)C(O)=O</span>
<span class="co">#&gt;   </span>
<span class="co">#&gt; • Classification Version: 2.1</span>
<span class="co">#&gt;   </span>
<span class="co">#&gt; kingdom : Organic compounds</span>
<span class="co">#&gt; └─superclass : Organic acids and derivatives</span>
<span class="co">#&gt;   └─class : Carboxylic acids and derivatives</span>
<span class="co">#&gt;     └─subclass : Amino acids, peptides, and analogues</span>
<span class="co">#&gt;       └─level 5 : Amino acids and derivatives</span>
<span class="co">#&gt;         └─level 6 : Alpha amino acids and derivatives</span>
<span class="co">#&gt;           └─level 7 : Histidine and derivatives</span></code></pre></div>
<p>The result of each classification is stored in a single S4 (ClassyFire) object. To retrieve multiple classification, simply iterate over a vector of InChI Keys’</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">InChI_Keys</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'BRMWTNUJHUMWMS-LURJTMIESA-N'</span>,
    <span class="st">'MDHYEMXUFSJLGV-UHFFFAOYSA-N'</span>,
    <span class="st">'MYYIAHXIVFADCU-QMMMGPOBSA-N'</span><span class="op">)</span>


<span class="va">Classification_List</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map</a></span><span class="op">(</span><span class="va">InChI_Keys</span>, <span class="va">get_classification</span><span class="op">)</span>
<span class="co">#&gt; ✔ BRMWTNUJHUMWMS-LURJTMIESA-N</span>
<span class="co">#&gt; ✔ MDHYEMXUFSJLGV-UHFFFAOYSA-N</span>
<span class="co">#&gt; ✔ MYYIAHXIVFADCU-QMMMGPOBSA-N</span></code></pre></div>
</div>
<div id="submit-multiple-queries" class="section level2">
<h2 class="hasAnchor">
<a href="#submit-multiple-queries" class="anchor"></a>Submit Multiple Queries</h2>
<p>For classification submission using SMILES, this can be performed by supplying multiple SMILES to the <code>submit_query</code> function. The results from <strong>all</strong> of the inputs, will be returned to a single S4 <code>Query</code> class.</p>
<p>If any of the inputs are not successfully classified, then these will be stored in the <code>unclassified</code> slot and can be accessed using the <code>unclassified</code> accessor method.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true"></a>Input &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dt">MOL1 =</span> <span class="st">'CCCOCC'</span>, <span class="dt">MOL2 =</span> <span class="st">'CNC(CC1=CN=CN1)C(=O)O'</span>, <span class="dt">MOL3 =</span> <span class="st">'CXN'</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true"></a>Query &lt;-</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true"></a><span class="st">  </span><span class="kw">submit_query</span>(<span class="dt">label =</span> <span class="st">'query_test'</span>,</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true"></a>               <span class="dt">input =</span> Input,</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true"></a>               <span class="dt">type =</span> <span class="st">'STRUCTURE'</span>)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true"></a>               </span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true"></a>               </span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true"></a>Query</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true"></a>── ClassyFire Query Object ──────────────────────────────── classyfireR v0.<span class="fl">3.7</span> ── </span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true"></a>Object Size<span class="op">:</span><span class="st"> </span><span class="fl">27.6</span> Kb </span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true"></a> </span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true"></a><span class="dv">2</span> structures classified </span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true"></a>• MOL1 <span class="op">:</span><span class="st"> </span>InChIKey=NVJUHMXYKCUMQA<span class="op">-</span>UHFFFAOYSA<span class="op">-</span>N</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true"></a>• MOL2 <span class="op">:</span><span class="st"> </span>InChIKey=CYZKJBZEIFWZSR<span class="op">-</span>UHFFFAOYSA<span class="op">-</span>N</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true"></a></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true"></a><span class="dv">1</span> structures not classified </span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true"></a>• MOL3 <span class="op">:</span><span class="st"> </span>CXN               </span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true"></a></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true"></a></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true"></a></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true"></a><span class="kw">unclassified</span>(Query)</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true"></a></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true"></a> MOL3 </span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true"></a><span class="st">"CXN"</span> </span></code></pre></div>
</div>
<div id="accessor-methods" class="section level2">
<h2 class="hasAnchor">
<a href="#accessor-methods" class="anchor"></a>Accessor Methods</h2>
<p>There are a series of accessor methods which will work with either object type to return results from a specific slot in the object.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="fu"><a href="../reference/classification.html">classification</a></span><span class="op">(</span><span class="va">Classification</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 7 × 3</span>
<span class="co">#&gt;   Level      Classification                       CHEMONT          </span>
<span class="co">#&gt;   &lt;chr&gt;      &lt;chr&gt;                                &lt;chr&gt;            </span>
<span class="co">#&gt; 1 kingdom    Organic compounds                    CHEMONTID:0000000</span>
<span class="co">#&gt; 2 superclass Organic acids and derivatives        CHEMONTID:0000264</span>
<span class="co">#&gt; 3 class      Carboxylic acids and derivatives     CHEMONTID:0000265</span>
<span class="co">#&gt; 4 subclass   Amino acids, peptides, and analogues CHEMONTID:0000013</span>
<span class="co">#&gt; 5 level 5    Amino acids and derivatives          CHEMONTID:0000347</span>
<span class="co">#&gt; 6 level 6    Alpha amino acids and derivatives    CHEMONTID:0000060</span>
<span class="co">#&gt; 7 level 7    Histidine and derivatives            CHEMONTID:0004311</span>


<span class="fu"><a href="../reference/meta.html">meta</a></span><span class="op">(</span><span class="va">Classification</span><span class="op">)</span>
<span class="co">#&gt; $inchikey</span>
<span class="co">#&gt; [1] "InChIKey=BRMWTNUJHUMWMS-LURJTMIESA-N"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $smiles</span>
<span class="co">#&gt; [1] "[H][C@](N)(CC1=CN(C)C=N1)C(O)=O"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $version</span>
<span class="co">#&gt; [1] "2.1"</span>


<span class="fu"><a href="../reference/chebi.html">chebi</a></span><span class="op">(</span><span class="va">Classification</span><span class="op">)</span>
<span class="co">#&gt;  [1] "L-alpha-amino acid (CHEBI:15705)"                  </span>
<span class="co">#&gt;  [2] "imidazolyl carboxylic acid (CHEBI:38307)"          </span>
<span class="co">#&gt;  [3] "aralkylamine (CHEBI:18000)"                        </span>
<span class="co">#&gt;  [4] "imidazoles (CHEBI:24780)"                          </span>
<span class="co">#&gt;  [5] "organic aromatic compound (CHEBI:33659)"           </span>
<span class="co">#&gt;  [6] "amino acid (CHEBI:33709)"                          </span>
<span class="co">#&gt;  [7] "carbonyl compound (CHEBI:36586)"                   </span>
<span class="co">#&gt;  [8] "carboxylic acid (CHEBI:33575)"                     </span>
<span class="co">#&gt;  [9] "carboxylic acid anion (CHEBI:29067)"               </span>
<span class="co">#&gt; [10] "organonitrogen heterocyclic compound (CHEBI:38101)"</span>
<span class="co">#&gt; [11] "pnictogen molecular entity (CHEBI:33302)"          </span>
<span class="co">#&gt; [12] "organic molecular entity (CHEBI:50860)"            </span>
<span class="co">#&gt; [13] "organic oxide (CHEBI:25701)"                       </span>
<span class="co">#&gt; [14] "alkylamine (CHEBI:13759)"                          </span>
<span class="co">#&gt; [15] "organic molecule (CHEBI:72695)"                    </span>
<span class="co">#&gt; [16] "histidine derivative (CHEBI:24599)"                </span>
<span class="co">#&gt; [17] "chemical entity (CHEBI:24431)"                     </span>
<span class="co">#&gt; [18] "organooxygen compound (CHEBI:36963)"               </span>
<span class="co">#&gt; [19] "peptide (CHEBI:16670)"                             </span>
<span class="co">#&gt; [20] "organonitrogen compound (CHEBI:35352)"             </span>
<span class="co">#&gt; [21] "alpha-amino acid (CHEBI:33704)"                    </span>
<span class="co">#&gt; [22] "organic heterocyclic compound (CHEBI:24532)"       </span>
<span class="co">#&gt; [23] "azole (CHEBI:68452)"                               </span>
<span class="co">#&gt; [24] "nitrogen molecular entity (CHEBI:51143)"           </span>
<span class="co">#&gt; [25] "amine (CHEBI:32952)"                               </span>
<span class="co">#&gt; [26] "oxygen molecular entity (CHEBI:25806)"             </span>
<span class="co">#&gt; [27] "primary amine (CHEBI:32877)"</span></code></pre></div>
</div>
<div id="working-with-a-local-cache" class="section level2">
<h2 class="hasAnchor">
<a href="#working-with-a-local-cache" class="anchor"></a>Working with a local cache</h2>
<p>A local cache can be used to save queries too, which will speed up workflows where large numbers of entities are being classified each time, and will mean that the API only queries the server, when absolutely necessary.</p>
<p>A local cache can easily be created using the following command</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ClassyFireDB</span> <span class="op">&lt;-</span> <span class="fu">RSQLite</span><span class="fu">::</span><span class="fu">dbConnect</span><span class="op">(</span><span class="fu">RSQLite</span><span class="fu">::</span><span class="fu"><a href="https://rsqlite.r-dbi.org/reference/SQLite.html">SQLite</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">'ClassyFireCache.db'</span><span class="op">)</span></code></pre></div>
<p>Before running the <code>get_classifcation</code> function, a connection to the cache needs to be created.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ClassyFireCache</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/open_cache.html">open_cache</a></span><span class="op">(</span>dbname <span class="op">=</span> <span class="st">'ClassyFireCache.db'</span><span class="op">)</span></code></pre></div>
<p>Then pass the cache variable as the <code>conn</code> argument in the <code>get_classification</code> function.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/get_classification.html">get_classification</a></span><span class="op">(</span><span class="st">'BRMWTNUJHUMWMS-LURJTMIESA-N'</span>, conn <span class="op">=</span> <span class="va">ClassyFireCache</span><span class="op">)</span></code></pre></div>
</div>
<div id="acknowledgements" class="section level2">
<h2 class="hasAnchor">
<a href="#acknowledgements" class="anchor"></a>Acknowledgements</h2>
<p>If you use <code>classyfireR</code> you should cite the <a href="https://jcheminf.biomedcentral.com/articles/10.1186/s13321-016-0174-y">ClassyFire</a> publication</p>
<blockquote>
<p><strong><em>Djoumbou Feunang Y, Eisner R, Knox C, Chepelev L, Hastings J, Owen G, Fahy E, Steinbeck C, Subramanian S, Bolton E, Greiner R, and Wishart DS</em></strong>. ClassyFire: Automated Chemical Classification With A Comprehensive, Computable Taxonomy. Journal of Cheminformatics, 2016, 8:61.</p>
</blockquote>
<blockquote>
<p><strong>DOI:</strong> <a href="https://jcheminf.biomedcentral.com/articles/10.1186/s13321-016-0174-y">10.1186/s13321-016-0174-y</a></p>
</blockquote>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Tom Wilson, Jasen Finch.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
